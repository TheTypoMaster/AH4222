<html>
   <head>
      <meta HTTP-EQUIV='Pragma' CONTENT='no-cache'>
      <link rel="stylesheet" href='stylemain.css' type='text/css'>
         <link rel="stylesheet" href='colors.css' type='text/css'>
            <script language="javascript" src="util.js"></script>
            <script language="javascript">
<!-- hide
var msg = new Array();
msg[0] = 'Uploading is in progress. The DSL Router will reboot upon completion. This process will take about 5 minutes, if the new software is available.';
msg[1] = 'Image uploading failed. The system is out of memory. The DSL Router is rebooting.';
msg[2] = 'Image uploading failed. No image file was selected.';
msg[3] = 'Image uploading failed. The selected file contains an illegal image.';
msg[4] = 'Fatal error during image uploading.';

var idxStr = '<%ejGetOther(sysInfo, upldSts)%>';

function getMsgIndex() {
   var idxNum = parseInt(idxStr);
   if ( isNaN(idxNum) || idxNum < 0 || idxNum > 4 )
      idxNum = 4;

   return idxNum;
}

function reboot() {
   var enblPopWin = '<%ejGet(enblPopWin)%>';
   var loc = 'main.html';
   if (isNetscape())
      var code = 'window.top.location.replace("' + loc + '")';
   else
      var code = 'window.top.location.assign("' + loc + '")';

   if ( enblPopWin == '1' ) {
      loc = 'index.html';
      if (isNetscape())
         var code = 'location.replace("' + loc + '")';
      else
         code = 'location.assign("' + loc + '")';
   }

   eval(code);
}

function frmLoad() {
   // only reboot if upload progress is successful
   if ( getMsgIndex() == 0 )
      setTimeout('reboot()', 40000);
}

function btnBack() {
   if (isNetscape())
      var code = 'location.replace("' + 'upload.cgi' + '")';
   else
      var code = 'location.assign("' + 'upload.cgi' + '")';

   if (<%ejGet(glbUploadMode)%> == 2)
   {
      if (isNetscape())
         code = 'location.replace("' + 'updatesettings.cgi' + '")';
      else
         code = 'location.assign("' + 'updatesettings.cgi' + '")';
   }
   eval(code);
}

// done hiding -->
</script>
   </head>
   <body onLoad='frmLoad()'>
      <blockquote> <b>DSL Router Update</b><br>
         <br>
         <script language="javascript" src="util.js"></script>
         <script language="javascript">
<!-- hide
document.write(msg[getMsgIndex()]);
// done hiding -->
</script>
         <br>
         <br>
         <center>
            <input type='button' onClick='btnBack()' value='Back'>
         </center>
      </blockquote>
   </body>
</html>
